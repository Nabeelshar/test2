{"version":3,"file":"mqtt.66bee222.js","sources":["../../../hoppscotch-common/src/components/realtime/Subscription.vue","../../../hoppscotch-common/src/components/realtime/ConnectionConfig.vue","../../../hoppscotch-common/src/pages/realtime/mqtt.vue"],"sourcesContent":["<template>\n  <HoppSmartModal v-if=\"show\" dialog :title=\"t('mqtt.new')\" @close=\"hideModal\">\n    <template #body>\n      <div class=\"flex justify-between mb-4\">\n        <div\n          class=\"flex items-center border divide-x rounded border-divider divide-divider\"\n        >\n          <label class=\"mx-4\">\n            {{ t(\"mqtt.qos\") }}\n          </label>\n          <tippy interactive trigger=\"click\" theme=\"popover\">\n            <span class=\"select-wrapper\">\n              <HoppButtonSecondary class=\"pr-8\" :label=\"`${QoS}`\" />\n            </span>\n            <template #content=\"{ hide }\">\n              <div class=\"flex flex-col\" role=\"menu\">\n                <HoppSmartItem\n                  v-for=\"item in QOS_VALUES\"\n                  :key=\"`qos-${item}`\"\n                  :label=\"`${item}`\"\n                  :icon=\"QoS === item ? IconCheckCircle : IconCircle\"\n                  :active=\"QoS === item\"\n                  @click=\"\n                    () => {\n                      QoS = item\n                      hide()\n                    }\n                  \"\n                />\n              </div>\n            </template>\n          </tippy>\n        </div>\n      </div>\n      <div class=\"relative flex flex-col\">\n        <input\n          id=\"selectLabelAdd\"\n          v-model=\"name\"\n          v-focus\n          class=\"input floating-input\"\n          placeholder=\" \"\n          type=\"text\"\n          autocomplete=\"off\"\n          @keyup.enter=\"addNewSubscription\"\n        />\n        <label for=\"selectLabelAdd\">\n          {{ t(\"action.label\") }}\n        </label>\n        <span class=\"end-actions\">\n          <label\n            v-tippy=\"{ theme: 'tooltip' }\"\n            :title=\"t('mqtt.color')\"\n            for=\"select-color\"\n            class=\"absolute inset-0 flex items-center justify-center group hover:cursor-pointer\"\n          >\n            <icon-lucide-brush\n              class=\"transition opacity-80 svg-icons group-hover:opacity-100 text-accentContrast\"\n            />\n          </label>\n          <input\n            id=\"select-color\"\n            v-model=\"color\"\n            type=\"color\"\n            class=\"w-8 h-8 p-1 rounded bg-primary color-picker\"\n          />\n        </span>\n      </div>\n    </template>\n    <template #footer>\n      <span class=\"flex space-x-2\">\n        <HoppButtonPrimary\n          :label=\"t('mqtt.subscribe')\"\n          :loading=\"loadingState\"\n          outline\n          @click=\"addNewSubscription\"\n        />\n        <HoppButtonSecondary\n          :label=\"t('action.cancel')\"\n          outline\n          filled\n          @click=\"hideModal\"\n        />\n      </span>\n    </template>\n  </HoppSmartModal>\n</template>\n\n<script lang=\"ts\" setup>\nimport IconCheckCircle from \"~icons/lucide/check-circle\"\nimport IconCircle from \"~icons/lucide/circle\"\nimport { ref, watch } from \"vue\"\nimport { MQTTTopic, QOS_VALUES } from \"~/helpers/realtime/MQTTConnection\"\nimport { useI18n } from \"@composables/i18n\"\nimport { useToast } from \"@composables/toast\"\n\nconst toastr = useToast()\nconst t = useI18n()\n\nconst props = defineProps({\n  show: {\n    type: Boolean,\n    default: false,\n  },\n  loadingState: {\n    type: Boolean,\n    default: false,\n  },\n})\n\nconst emit = defineEmits<{\n  (e: \"hide-modal\"): void\n  (e: \"submit\", body: MQTTTopic): void\n}>()\n\nconst QoS = ref<(typeof QOS_VALUES)[number]>(2)\nconst name = ref(\"\")\nconst color = ref(\"#f58290\")\n\nwatch(\n  () => props.show,\n  () => {\n    name.value = \"\"\n    QoS.value = 2\n    const randomColor = Math.floor(Math.random() * 16777215).toString(16)\n    color.value = `#${randomColor}`\n  }\n)\n\nconst addNewSubscription = () => {\n  if (!name.value) {\n    toastr.error(t(\"mqtt.invalid_topic\").toString())\n    return\n  }\n  emit(\"submit\", {\n    name: name.value,\n    qos: QoS.value,\n    color: color.value,\n  })\n}\nconst hideModal = () => {\n  name.value = \"\"\n  QoS.value = 2\n  emit(\"hide-modal\")\n}\n</script>\n","<template>\n  <div class=\"flex flex-col flex-1\">\n    <div\n      class=\"sticky z-10 flex items-center justify-between flex-shrink-0 py-2 pl-4 pr-2 overflow-x-auto border-b bg-primary border-dividerLight top-upperPrimaryStickyFold\"\n    >\n      <span class=\"flex items-center\">\n        <label class=\"font-semibold truncate text-secondaryLight\">\n          {{ t(\"mqtt.connection_config\") }}\n        </label>\n      </span>\n      <div class=\"flex\">\n        <HoppSmartCheckbox\n          :on=\"config.cleanSession\"\n          class=\"px-2\"\n          @change=\"config.cleanSession = !config.cleanSession\"\n          >{{ t(\"mqtt.clean_session\") }}\n        </HoppSmartCheckbox>\n      </div>\n    </div>\n    <div class=\"flex flex-1 h-full border-dividerLight\">\n      <div class=\"w-1/3 border-r border-dividerLight\">\n        <div class=\"flex flex-1 border-b border-dividerLight\">\n          <SmartEnvInput\n            v-model=\"config.username\"\n            :placeholder=\"t('authorization.username')\"\n          />\n        </div>\n        <div class=\"flex flex-1 border-b border-dividerLight\">\n          <SmartEnvInput\n            v-model=\"config.password\"\n            :placeholder=\"t('authorization.password')\"\n          />\n        </div>\n        <div class=\"flex items-center border-b border-dividerLight\">\n          <label class=\"ml-4 text-secondaryLight\">\n            {{ t(\"mqtt.keep_alive\") }}\n          </label>\n          <SmartEnvInput\n            v-model=\"config.keepAlive\"\n            :placeholder=\"t('mqtt.keep_alive')\"\n          />\n        </div>\n      </div>\n      <div class=\"w-2/3\">\n        <div class=\"flex flex-1 border-b border-dividerLight\">\n          <SmartEnvInput\n            v-model=\"config.lwTopic\"\n            :placeholder=\"t('mqtt.lw_topic')\"\n          />\n        </div>\n        <div class=\"flex flex-1 border-b border-dividerLight\">\n          <SmartEnvInput\n            v-model=\"config.lwMessage\"\n            :placeholder=\"t('mqtt.lw_message')\"\n          />\n        </div>\n        <div\n          class=\"flex items-center justify-between px-4 border-b border-dividerLight\"\n        >\n          <div class=\"flex items-center\">\n            <label class=\"font-semibold truncate text-secondaryLight\">\n              {{ t(\"mqtt.lw_qos\") }}\n            </label>\n            <tippy interactive trigger=\"click\" theme=\"popover\">\n              <span class=\"select-wrapper\">\n                <HoppButtonSecondary\n                  class=\"pr-8 ml-2 rounded-none\"\n                  :label=\"`${config.lwQos}`\"\n                />\n              </span>\n              <template #content=\"{ hide }\">\n                <div class=\"flex flex-col\" role=\"menu\">\n                  <HoppSmartItem\n                    v-for=\"item in QOS_VALUES\"\n                    :key=\"`qos-${item}`\"\n                    :label=\"`${item}`\"\n                    :icon=\"config.lwQos === item ? IconCheckCircle : IconCircle\"\n                    :active=\"config.lwQos === item\"\n                    @click=\"\n                      () => {\n                        config.lwQos = item\n                        hide()\n                      }\n                    \"\n                  />\n                </div>\n              </template>\n            </tippy>\n          </div>\n          <HoppSmartCheckbox\n            :on=\"config.lwRetain\"\n            class=\"py-2\"\n            @change=\"config.lwRetain = !config.lwRetain\"\n            >{{ t(\"mqtt.lw_retain\") }}\n          </HoppSmartCheckbox>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport IconCheckCircle from \"~icons/lucide/check-circle\"\nimport IconCircle from \"~icons/lucide/circle\"\nimport { ref, watch } from \"vue\"\nimport { useI18n } from \"@composables/i18n\"\nimport {\n  MQTTConnectionConfig,\n  QOS_VALUES,\n} from \"~/helpers/realtime/MQTTConnection\"\n\nconst t = useI18n()\n\nconst emit = defineEmits<{\n  (e: \"change\", body: MQTTConnectionConfig): void\n}>()\nconst config = ref<MQTTConnectionConfig>({\n  username: \"\",\n  password: \"\",\n  keepAlive: \"60\",\n  cleanSession: true,\n  lwTopic: \"\",\n  lwMessage: \"\",\n  lwQos: 0,\n  lwRetain: false,\n})\n\nwatch(\n  config,\n  (newVal) => {\n    emit(\"change\", newVal)\n  },\n  { immediate: true }\n)\n</script>\n","<template>\n  <AppPaneLayout layout-id=\"mqtt\">\n    <template #primary>\n      <div\n        class=\"sticky top-0 z-10 flex flex-shrink-0 p-4 space-x-2 overflow-x-auto bg-primary\"\n      >\n        <div class=\"inline-flex flex-1 space-x-2\">\n          <div class=\"flex flex-1\">\n            <input\n              id=\"mqtt-url\"\n              v-model=\"url\"\n              type=\"url\"\n              autocomplete=\"off\"\n              :class=\"{ error: !isUrlValid }\"\n              class=\"flex flex-1 w-full px-4 py-2 border rounded-l bg-primaryLight border-divider text-secondaryDark\"\n              :placeholder=\"`${t('mqtt.url')}`\"\n              :disabled=\"\n                connectionState === 'CONNECTED' ||\n                connectionState === 'CONNECTING'\n              \"\n              @keyup.enter=\"isUrlValid ? toggleConnection() : null\"\n            />\n            <label\n              for=\"client-id\"\n              class=\"px-4 py-2 font-semibold truncate border-t border-b bg-primaryLight border-divider text-secondaryLight\"\n            >\n              {{ t(\"mqtt.client_id\") }}\n            </label>\n            <input\n              id=\"client-id\"\n              v-model=\"clientID\"\n              class=\"flex flex-1 w-full px-4 py-2 border rounded-r bg-primaryLight border-divider text-secondaryDark\"\n              spellcheck=\"false\"\n              :disabled=\"\n                connectionState === 'CONNECTED' ||\n                connectionState === 'CONNECTING'\n              \"\n              @keyup.enter=\"isUrlValid ? toggleConnection() : null\"\n            />\n          </div>\n          <HoppButtonPrimary\n            id=\"connect\"\n            :disabled=\"!isUrlValid\"\n            class=\"w-32\"\n            :label=\"\n              connectionState === 'CONNECTING'\n                ? t('action.connecting')\n                : connectionState === 'DISCONNECTED'\n                ? t('action.connect')\n                : t('action.disconnect')\n            \"\n            :loading=\"connectionState === 'CONNECTING'\"\n            @click=\"toggleConnection\"\n          />\n        </div>\n      </div>\n\n      <div\n        class=\"flex flex-col flex-1\"\n        :class=\"{ '!hidden': connectionState === 'CONNECTED' }\"\n      >\n        <RealtimeConnectionConfig @change=\"onChangeConfig\" />\n      </div>\n      <RealtimeCommunication\n        v-if=\"connectionState === 'CONNECTED'\"\n        :show-event-field=\"currentTabId === 'all'\"\n        :is-connected=\"connectionState === 'CONNECTED'\"\n        event-field-styles=\"top-upperPrimaryStickyFold\"\n        :sticky-header-styles=\"\n          currentTabId === 'all'\n            ? 'top-upperSecondaryStickyFold'\n            : 'top-upperPrimaryStickyFold'\n        \"\n        @send-message=\"\n          publish(\n            currentTabId === 'all'\n              ? $event\n              : {\n                  message: $event.message,\n                  eventName: currentTabId,\n                }\n          )\n        \"\n      />\n    </template>\n    <template #secondary>\n      <HoppSmartWindows\n        :id=\"'communication_tab'\"\n        v-model=\"currentTabId\"\n        :can-add-new-tab=\"false\"\n        @remove-tab=\"removeTab\"\n        @sort=\"sortTabs\"\n      >\n        <HoppSmartWindow\n          v-for=\"tab in tabs\"\n          :id=\"tab.id\"\n          :key=\"'removable_tab_' + tab.id\"\n          :label=\"tab.name\"\n          :is-removable=\"tab.removable\"\n        >\n          <template #icon>\n            <icon-lucide-rss\n              :style=\"{\n                color: tab.color,\n              }\"\n              class=\"w-4 h-4 svg-icons\"\n            />\n          </template>\n          <RealtimeLog\n            :title=\"t('mqtt.log')\"\n            :log=\"((tab.id === 'all' ? logs : tab.logs) as LogEntryData[])\"\n            @delete=\"clearLogEntries()\"\n          />\n        </HoppSmartWindow>\n      </HoppSmartWindows>\n    </template>\n    <template #sidebar>\n      <div\n        class=\"sticky z-10 flex flex-col flex-shrink-0 overflow-x-auto border-b divide-y rounded-t divide-dividerLight bg-primary border-dividerLight\"\n      >\n        <div class=\"flex justify-between flex-1\">\n          <HoppButtonSecondary\n            :icon=\"IconPlus\"\n            :label=\"t('mqtt.new')\"\n            class=\"!rounded-none\"\n            @click=\"showSubscriptionModal(true)\"\n          />\n          <span class=\"flex\">\n            <HoppButtonSecondary\n              v-tippy=\"{ theme: 'tooltip' }\"\n              to=\"https://docs.hoppscotch.io/features/mqtt\"\n              blank\n              :title=\"t('app.wiki')\"\n              :icon=\"IconHelpCircle\"\n            />\n          </span>\n        </div>\n      </div>\n\n      <div\n        v-if=\"topics.length === 0\"\n        class=\"flex flex-col items-center justify-center p-4 text-secondaryLight\"\n      >\n        <img\n          :src=\"`/images/states/${colorMode.value}/pack.svg`\"\n          loading=\"lazy\"\n          class=\"inline-flex flex-col object-contain object-center w-16 h-16 my-4\"\n          :alt=\"`${t('empty.subscription')}`\"\n        />\n        <span class=\"pb-4 text-center\">\n          {{ t(\"empty.subscription\") }}\n        </span>\n        <HoppButtonSecondary\n          :label=\"t('mqtt.new')\"\n          filled\n          outline\n          @click=\"showSubscriptionModal(true)\"\n        />\n      </div>\n\n      <div v-else>\n        <div\n          v-for=\"(topic, index) in topics\"\n          :key=\"`subscription-${index}`\"\n          class=\"flex flex-col\"\n        >\n          <div class=\"flex items-stretch group\">\n            <span class=\"flex items-center justify-center px-4 cursor-pointer\">\n              <icon-lucide-rss\n                :style=\"{\n                  color: topic.color,\n                }\"\n                class=\"w-4 h-4 svg-icons\"\n              />\n            </span>\n            <span\n              class=\"flex flex-1 min-w-0 py-2 pr-2 transition cursor-pointer group-hover:text-secondaryDark\"\n              @click=\"openTopicAsTab(topic)\"\n            >\n              <span class=\"truncate\">\n                {{ topic.name }}\n              </span>\n            </span>\n            <HoppButtonSecondary\n              v-tippy=\"{ theme: 'tooltip' }\"\n              :icon=\"IconTrash\"\n              color=\"red\"\n              :title=\"t('mqtt.unsubscribe')\"\n              class=\"hidden group-hover:inline-flex\"\n              data-testid=\"unsubscribe_mqtt_subscription\"\n              @click=\"unsubscribeFromTopic(topic.name)\"\n            />\n          </div>\n        </div>\n      </div>\n\n      <RealtimeSubscription\n        :show=\"subscriptionModalShown\"\n        :loading-state=\"subscribing\"\n        @submit=\"subscribeToTopic\"\n        @hide-modal=\"showSubscriptionModal(false)\"\n      />\n    </template>\n  </AppPaneLayout>\n</template>\n\n<script setup lang=\"ts\">\nimport IconPlus from \"~icons/lucide/plus\"\nimport IconTrash from \"~icons/lucide/trash\"\nimport IconHelpCircle from \"~icons/lucide/help-circle\"\nimport { computed, onMounted, onUnmounted, ref, watch } from \"vue\"\nimport debounce from \"lodash-es/debounce\"\nimport {\n  MQTTConnection,\n  MQTTConnectionConfig,\n  MQTTError,\n  MQTTTopic,\n} from \"~/helpers/realtime/MQTTConnection\"\nimport { HoppRealtimeLogLine } from \"~/helpers/types/HoppRealtimeLog\"\nimport { useColorMode } from \"@composables/theming\"\nimport {\n  useReadonlyStream,\n  useStream,\n  useStreamSubscriber,\n} from \"@composables/stream\"\nimport { useI18n } from \"@composables/i18n\"\nimport { useToast } from \"@composables/toast\"\nimport {\n  addMQTTLogLine,\n  MQTTConn$,\n  MQTTEndpoint$,\n  MQTTClientID$,\n  MQTTLog$,\n  setMQTTConn,\n  setMQTTEndpoint,\n  setMQTTClientID,\n  setMQTTLog,\n  MQTTTabs$,\n  setMQTTTabs,\n  MQTTCurrentTab$,\n  setCurrentTab,\n  addMQTTCurrentTabLogLine,\n} from \"~/newstore/MQTTSession\"\nimport RegexWorker from \"@workers/regex?worker\"\nimport { LogEntryData } from \"~/components/realtime/Log.vue\"\n\nconst t = useI18n()\nconst toast = useToast()\nconst colorMode = useColorMode()\n\nconst { subscribeToStream } = useStreamSubscriber()\nconst url = useStream(MQTTEndpoint$, \"\", setMQTTEndpoint)\nconst clientID = useStream(MQTTClientID$, \"\", setMQTTClientID)\nconst config = ref<MQTTConnectionConfig>({\n  username: \"\",\n  password: \"\",\n  keepAlive: \"60\",\n  cleanSession: true,\n  lwTopic: \"\",\n  lwMessage: \"\",\n  lwQos: 0,\n  lwRetain: false,\n})\nconst logs = useStream(MQTTLog$, [], setMQTTLog)\nconst socket = useStream(MQTTConn$, new MQTTConnection(), setMQTTConn)\nconst connectionState = useReadonlyStream(\n  socket.value.connectionState$,\n  \"DISCONNECTED\"\n)\nconst subscriptionState = useReadonlyStream(\n  socket.value.subscriptionState$,\n  false\n)\nconst subscribing = useReadonlyStream(socket.value.subscribing$, false)\nconst isUrlValid = ref(true)\nconst subTopic = ref(\"\")\nlet worker: Worker\nconst subscriptionModalShown = ref(false)\nconst canSubscribe = computed(() => connectionState.value === \"CONNECTED\")\nconst topics = useReadonlyStream(socket.value.subscribedTopics$, [])\n\nconst currentTabId = useStream(MQTTCurrentTab$, \"\", setCurrentTab)\nconst tabs = useStream(MQTTTabs$, [], setMQTTTabs)\n\nconst onChangeConfig = (e: MQTTConnectionConfig) => {\n  config.value = e\n}\n\nconst showSubscriptionModal = (show: boolean) => {\n  subscriptionModalShown.value = show\n}\nconst workerResponseHandler = ({\n  data,\n}: {\n  data: { url: string; result: boolean }\n}) => {\n  if (data.url === url.value) isUrlValid.value = data.result\n}\nonMounted(() => {\n  worker = new RegexWorker()\n  worker.addEventListener(\"message\", workerResponseHandler)\n  subscribeToStream(socket.value.event$, (event) => {\n    switch (event?.type) {\n      case \"CONNECTING\":\n        logs.value = [\n          {\n            payload: `${t(\"state.connecting_to\", { name: url.value })}`,\n            source: \"info\",\n            color: \"var(--accent-color)\",\n            ts: undefined,\n          },\n        ]\n        break\n      case \"CONNECTED\":\n        logs.value = [\n          {\n            payload: `${t(\"state.connected_to\", { name: url.value })}`,\n            source: \"info\",\n            color: \"var(--accent-color)\",\n            ts: Date.now(),\n          },\n        ]\n        toast.success(`${t(\"state.connected\")}`)\n        break\n      case \"MESSAGE_SENT\":\n        addLog(\n          {\n            prefix: `${event.message.topic}`,\n            payload: event.message.message,\n            source: \"client\",\n            ts: Date.now(),\n          },\n          event.message.topic\n        )\n        break\n      case \"MESSAGE_RECEIVED\":\n        addLog(\n          {\n            prefix: `${event.message.topic}`,\n            payload: event.message.message,\n            source: \"server\",\n            ts: event.time,\n          },\n          event.message.topic\n        )\n        break\n      case \"SUBSCRIBED\":\n        showSubscriptionModal(false)\n        addMQTTLogLine({\n          payload: subscriptionState.value\n            ? `${t(\"state.subscribed_success\", { topic: event.topic })}`\n            : `${t(\"state.unsubscribed_success\", { topic: event.topic })}`,\n          source: \"server\",\n          ts: event.time,\n        })\n        break\n      case \"SUBSCRIPTION_FAILED\":\n        addMQTTLogLine({\n          payload: subscriptionState.value\n            ? `${t(\"state.subscribed_failed\", { topic: subTopic.value })}`\n            : `${t(\"state.unsubscribed_failed\", { topic: subTopic.value })}`,\n          source: \"server\",\n          ts: event.time,\n        })\n        break\n      case \"ERROR\":\n        addMQTTLogLine({\n          payload: getI18nError(event.error),\n          source: \"info\",\n          color: \"#ff5555\",\n          ts: event.time,\n        })\n        break\n      case \"DISCONNECTED\":\n        addMQTTLogLine({\n          payload: t(\"state.disconnected_from\", { name: url.value }).toString(),\n          source: \"disconnected\",\n          color: \"#ff5555\",\n          ts: event.time,\n        })\n        toast.error(`${t(\"state.disconnected\")}`)\n        break\n    }\n  })\n})\nconst addLog = (line: HoppRealtimeLogLine, topic: string | undefined) => {\n  if (topic) addMQTTCurrentTabLogLine(topic, line)\n  addMQTTLogLine(line)\n}\nconst debouncer = debounce(function () {\n  worker.postMessage({ type: \"ws\", url: url.value })\n}, 1000)\nwatch(url, (newUrl) => {\n  if (newUrl) debouncer()\n})\nonUnmounted(() => {\n  worker.terminate()\n})\n// METHODS\nconst toggleConnection = () => {\n  // If it is connecting:\n  if (connectionState.value === \"DISCONNECTED\") {\n    return socket.value.connect(url.value, clientID.value, config.value)\n  }\n  // Otherwise, it's disconnecting.\n  socket.value.disconnect()\n}\nconst publish = (event: { message: string; eventName: string }) => {\n  socket.value?.publish(event.eventName, event.message)\n}\nconst subscribeToTopic = (topic: MQTTTopic) => {\n  if (canSubscribe.value) {\n    if (topics.value.some((t) => t.name === topic.name)) {\n      return toast.error(t(\"mqtt.already_subscribed\").toString())\n    }\n    socket.value.subscribe(topic)\n  } else {\n    subscriptionModalShown.value = false\n    toast.error(t(\"mqtt.not_connected\").toString())\n  }\n}\nconst unsubscribeFromTopic = (topic: string) => {\n  socket.value.unsubscribe(topic)\n  removeTab(topic)\n}\nconst getI18nError = (error: MQTTError): string => {\n  if (typeof error === \"string\") return error\n  switch (error.type) {\n    case \"CONNECTION_NOT_ESTABLISHED\":\n      return t(\"state.connection_lost\").toString()\n    case \"SUBSCRIPTION_FAILED\":\n      return t(\"state.mqtt_subscription_failed\", {\n        topic: error.topic,\n      }).toString()\n    case \"PUBLISH_ERROR\":\n      return t(\"state.publish_error\", { topic: error.topic }).toString()\n    case \"CONNECTION_LOST\":\n      return t(\"state.connection_lost\").toString()\n    case \"CONNECTION_FAILED\":\n      return t(\"state.connection_failed\").toString()\n    default:\n      return t(\"state.disconnected_from\", { name: url.value }).toString()\n  }\n}\nconst clearLogEntries = () => {\n  logs.value = []\n}\n\nconst openTopicAsTab = (topic: MQTTTopic) => {\n  const { name, color } = topic\n  if (tabs.value.some((tab) => tab.id === topic.name)) {\n    return (currentTabId.value = topic.name)\n  }\n  tabs.value = [\n    ...tabs.value,\n    {\n      id: name,\n      name,\n      color,\n      removable: true,\n      logs: [],\n    },\n  ]\n  currentTabId.value = name\n}\n\nconst sortTabs = (e: { oldIndex: number; newIndex: number }) => {\n  const newTabs = [...tabs.value]\n  newTabs.splice(e.newIndex, 0, newTabs.splice(e.oldIndex, 1)[0])\n  tabs.value = newTabs\n}\n\nconst removeTab = (tabID: string) => {\n  tabs.value = tabs.value.filter((tab) => tab.id !== tabID)\n}\n</script>\n"],"names":["toastr","useToast","t","useI18n","QoS","ref","name","color","watch","props","randomColor","addNewSubscription","emit","hideModal","config","newVal","toast","colorMode","useColorMode","subscribeToStream","useStreamSubscriber","url","useStream","MQTTEndpoint$","setMQTTEndpoint","clientID","MQTTClientID$","setMQTTClientID","logs","MQTTLog$","setMQTTLog","socket","MQTTConn$","MQTTConnection","setMQTTConn","connectionState","useReadonlyStream","subscriptionState","subscribing","isUrlValid","subTopic","worker","subscriptionModalShown","canSubscribe","computed","topics","currentTabId","MQTTCurrentTab$","setCurrentTab","tabs","MQTTTabs$","setMQTTTabs","onChangeConfig","e","showSubscriptionModal","show","workerResponseHandler","data","onMounted","RegexWorker","event","addLog","addMQTTLogLine","getI18nError","line","topic","addMQTTCurrentTabLogLine","debouncer","debounce","newUrl","onUnmounted","toggleConnection","publish","_a","subscribeToTopic","t2","unsubscribeFromTopic","removeTab","error","clearLogEntries","openTopicAsTab","tab","sortTabs","newTabs","tabID"],"mappings":"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"}