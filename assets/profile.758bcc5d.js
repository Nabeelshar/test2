var we=Object.defineProperty;var ke=(f,s,o)=>s in f?we(f,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[s]=o;var L=(f,s,o)=>(ke(f,typeof s!="symbol"?s+"":s,o),o);import{f as F,D as G,h as b,W as Ce,aX as Le,g as H,p as P,cd as De,aU as Ne,ce as Ee,z as ie,o as i,d as _,e as t,t as n,j as e,N as Ue,i as T,a as c,am as Me,b0 as Re,I as Ie,x as te,a6 as J,_ as ce,bJ as q,cf as ae,aL as O,cg as ne,ch as Ae,ci as He,cj as Te,U as de,V as I,ck as D,cl as Y,cm as je,cn as Ve,m as j,F as ue,l as he,c as A,w as E,Y as M,a2 as _e,co as se,cp as ze,b6 as Be,cq as pe,cr as qe,cs as Oe,X as Pe,v as ee,a9 as Ye,ct as Fe,ar as me,bX as Ge,E as Z,aN as Je,cu as Qe,a$ as le,Z as K,cv as We,H as Xe,cw as Ze,a4 as Ke,ac as et,cx as tt,a8 as st}from"./index.c3832659.js";import{s as ot,I as nt}from"./date.dcaddfa2.js";import{B as lt}from"./helpers.2f3e7a37.js";import{d as rt}from"./Shortcode.7c4e9d4f.js";const it={class:"block w-full my-6 border divide-y lg:flex lg:my-0 lg:border-0 lg:divide-y-0 lg:divide-x divide-dividerLight border-dividerLight"},ct={class:"font-mono text-tiny table-box"},at={class:"table-box"},dt={class:"justify-center table-box"},ut=F({__name:"Shortcode",props:{shortcode:null},emits:["delete-shortcode"],setup(f,{emit:s}){const o=f,l=G(),a=J(),h=g=>{s("delete-shortcode",g)},S={get:"text-green-500",post:"text-yellow-500",put:"text-blue-500",delete:"text-red-500",default:"text-gray-500"},p=b(),u=Ce(Le,1e3),y=H(()=>P(o.shortcode.request,JSON.parse,De)),w=H(()=>P(S,Ee(y.value.method.toLowerCase()),Ne(()=>S.default))),k=H(()=>ot(o.shortcode.createdOn)),d="https://hopp.sh",m=g=>{Re(`${d}/r/${g}`),a.success(`${l("state.copied_to_clipboard")}`),u.value=Ie};return(g,x)=>{const C=te,$=ie("tippy");return i(),_("div",it,[t("div",ct,n(f.shortcode.id),1),t("div",{class:Ue(["table-box",e(w)])},n(e(y).method),3),t("div",at,n(e(y).endpoint),1),t("div",{ref_key:"timeStampRef",ref:p,class:"table-box"},n(e(k)),513),t("div",dt,[T(c(C,{title:e(l)("action.open_workspace"),to:`${e(d)}/r/${f.shortcode.id}`,blank:"",icon:e(nt),class:"px-3 text-accent hover:text-accent"},null,8,["title","to","icon"]),[[$,{theme:"tooltip"}]]),T(c(C,{title:e(l)("action.copy"),color:"green",icon:e(u),class:"px-3",onClick:x[0]||(x[0]=r=>m(f.shortcode.id))},null,8,["title","icon"]),[[$,{theme:"tooltip"}]]),T(c(C,{title:e(l)("action.delete"),icon:e(Me),color:"red",class:"px-3",onClick:x[1]||(x[1]=r=>h(f.shortcode.id))},null,8,["title","icon"]),[[$,{theme:"tooltip"}]])])])}}});const ht=ce(ut,[["__scopeId","data-v-d532904a"]]);class _t{constructor(s=!1){L(this,"error$");L(this,"loading$");L(this,"shortcodes$");L(this,"hasMoreShortcodes$");L(this,"isDispose");L(this,"myShortcodesCreated");L(this,"myShortcodesRevoked");L(this,"myShortcodesCreatedSub");L(this,"myShortcodesRevokedSub");this.error$=new q(null),this.loading$=new q(!1),this.shortcodes$=new q([]),this.hasMoreShortcodes$=new q(!0),this.isDispose=!0,this.myShortcodesCreated=null,this.myShortcodesRevoked=null,this.myShortcodesCreatedSub=null,this.myShortcodesRevokedSub=null,s||this.initialize()}unsubscribeSubscriptions(){var s,o,l,a;(s=this.myShortcodesCreated)==null||s.unsubscribe(),(o=this.myShortcodesRevoked)==null||o.unsubscribe(),(l=this.myShortcodesCreatedSub)==null||l.unsubscribe(),(a=this.myShortcodesRevokedSub)==null||a.unsubscribe()}initialize(){if(!this.isDispose)throw new Error("Adapter is already initialized");this.fetchList(),this.registerSubscriptions()}isInitialized(){return!this.isDispose}dispose(){if(this.isDispose)throw new Error("Adapter has been disposed");this.isDispose=!0,this.unsubscribeSubscriptions()}fetchList(){this.loadMore(!0)}async loadMore(s=!1){if(!this.hasMoreShortcodes$.value&&!s)return;this.loading$.next(!0);const o=this.shortcodes$.value.length>0?this.shortcodes$.value[this.shortcodes$.value.length-1].id:void 0,l=await ae({query:Te,variables:{cursor:o}});if(O(l))throw this.error$.next(l.left),console.error(l.left),this.loading$.next(!1),new Error(`Failed fetching short codes list: ${l.left}`);const a=l.right.myShortcodes;this.pushNewShortcodes(a),a.length!==lt&&this.hasMoreShortcodes$.next(!1),this.loading$.next(!1)}pushNewShortcodes(s){const o=this.shortcodes$.value;o.push(...s),this.shortcodes$.next(o)}createShortcode(s){const o=this.shortcodes$.value;o.unshift(s),this.shortcodes$.next(o)}deleteShortcode(s){const o=this.shortcodes$.value.filter(({id:l})=>l!==s);this.shortcodes$.next(o)}registerSubscriptions(){const[s,o]=ne({query:Ae});this.myShortcodesCreatedSub=o,this.myShortcodesCreated=s.subscribe(h=>{if(O(h))throw console.error(h.left),new Error(`Shortcode Create Error ${h.left}`);this.createShortcode(h.right.myShortcodesCreated)});const[l,a]=ne({query:He});this.myShortcodesRevokedSub=a,this.myShortcodesRevoked=l.subscribe(h=>{if(O(h))throw console.error(h.left),new Error(`Shortcode Delete Error ${h.left}`);this.deleteShortcode(h.right.myShortcodesRevoked.id)})}}const pt={class:"p-4"},mt={class:"font-semibold text-secondaryDark"},ft={class:"my-1 text-secondaryLight"},vt={class:"relative py-4 overflow-x-auto"},yt={key:0,class:"flex flex-col items-center justify-center"},gt={class:"text-secondaryLight"},bt={key:1,class:"flex flex-col items-center justify-center p-4 text-secondaryLight"},xt=["src","alt"],$t={class:"mb-4 text-center"},St={key:2},wt={class:"hidden w-full border-t rounded-t bg-primaryLight lg:flex border-x border-dividerLight"},kt={class:"flex w-full overflow-y-scroll"},Ct={class:"table-box"},Lt={class:"table-box"},Dt={class:"table-box"},Nt={class:"table-box"},Et={class:"justify-center table-box"},Ut={class:"flex flex-col items-center justify-between w-full overflow-y-scroll border rounded max-h-sm lg:rounded-t-none lg:divide-y border-dividerLight divide-dividerLight"},Mt={key:0,class:"flex flex-col items-center py-3"},Rt={key:3,class:"flex flex-col items-center py-4"},It=F({__name:"Shortcodes",setup(f){var C,$;const s=G(),o=J(),l=_e();de({title:H(()=>s("navigation.profile"))});const a=I(D.auth.getCurrentUserStream(),D.auth.getCurrentUser()),h=b((C=a.value)==null?void 0:C.displayName);Y(()=>{var r;return h.value=(r=a.value)==null?void 0:r.displayName});const S=b(($=a.value)==null?void 0:$.email);Y(()=>{var r;return S.value=(r=a.value)==null?void 0:r.email});const p=new _t(!0),u=I(p.loading$,!1),y=I(p.error$,null),w=I(p.shortcodes$,[]),k=I(p.hasMoreShortcodes$,!0),d=H(()=>u.value&&w.value.length===0);je(()=>{try{p.initialize()}catch{}}),Ve(r=>{if(r.event==="logout"&&p.isInitialized()){p.dispose();return}});const m=r=>{P(rt(r),pe(R=>{o.error(`${x(R)}`)},()=>{o.success(`${s("shortcodes.deleted")}`)}))()},g=()=>{p.loadMore()},x=r=>{if(r.type==="network_error")return s("error.network_error");switch(r.error){case"shortcode/not_found":return s("shortcodes.not_found");default:return s("error.something_went_wrong")}};return(r,R)=>{const V=se,U=ht,v=ze,Q=Be;return i(),_("section",pt,[t("h4",mt,n(e(s)("settings.short_codes")),1),t("div",ft,n(e(s)("settings.short_codes_description")),1),t("div",vt,[e(d)?(i(),_("div",yt,[c(V,{class:"mb-4"}),t("span",gt,n(e(s)("state.loading")),1)])):j("",!0),!e(d)&&e(w).length===0?(i(),_("div",bt,[t("img",{src:`/images/states/${e(l).value}/add_files.svg`,loading:"lazy",class:"inline-flex flex-col object-contain object-center w-16 h-16 mb-8",alt:`${e(s)("empty.shortcodes")}`},null,8,xt),t("span",$t,n(e(s)("empty.shortcodes")),1)])):e(d)?j("",!0):(i(),_("div",St,[t("div",wt,[t("div",kt,[t("div",Ct,n(e(s)("shortcodes.short_code")),1),t("div",Lt,n(e(s)("shortcodes.method")),1),t("div",Dt,n(e(s)("shortcodes.url")),1),t("div",Nt,n(e(s)("shortcodes.created_on")),1),t("div",Et,n(e(s)("shortcodes.actions")),1)])]),t("div",Ut,[(i(!0),_(ue,null,he(e(w),(z,B)=>(i(),A(U,{key:`shortcode-${B}`,shortcode:z,onDeleteShortcode:m},null,8,["shortcode"]))),128)),e(k)&&e(w).length>0?(i(),A(v,{key:0,onIntersecting:R[0]||(R[0]=z=>g())},{default:E(()=>[e(u)?(i(),_("div",Mt,[c(V)])):j("",!0)]),_:1})):j("",!0)])])),!e(d)&&e(y)?(i(),_("div",Rt,[c(Q,{class:"mb-4 svg-icons"}),M(" "+n(x(e(y))),1)])):j("",!0)])])}}});const At=ce(It,[["__scopeId","data-v-818b2de1"]]),Ht=()=>qe(Oe,{}),Tt={class:"p-4"},jt={class:"font-semibold text-secondaryDark"},Vt={class:"my-1 mb-4 text-secondaryLight"},zt={key:0,class:"flex flex-col items-center justify-center"},Bt={class:"text-secondaryLight"},qt={key:1,class:"flex flex-col p-4 space-y-2 border border-red-500 rounded-lg text-secondaryDark bg-error"},Ot={class:"font-bold text-red-500"},Pt={class:"my-4 ml-8 space-y-2 list-disc"},Yt={class:"font-semibold"},Ft={key:2},Gt={class:"flex flex-col p-4 mb-4 space-y-2 border border-red-500 rounded-lg text-secondaryDark bg-error"},Jt={class:"font-bold text-red-500"},Qt={class:"font-medium text-secondaryDark"},Wt={class:"flex flex-col"},Xt=t("label",{for:"deleteUserAccount"},[M(" Type "),t("span",{class:"font-bold"}," delete my account "),M(" to confirm ")],-1),Zt={class:"flex space-x-2"},Kt=F({__name:"UserDelete",setup(f){const s=G(),o=J(),l=Ye(),a=b(!1),h=b(""),S=b(!0),p=b([]);Pe(a,d=>{d&&u()});const u=async()=>{S.value=!0;const d=await ae({query:Fe});if(S.value=!1,O(d))throw new Error(`Failed fetching teams list: ${JSON.stringify(d.left)}`);p.value=d.right.myTeams.filter(m=>m.ownersCount===1&&m.myRole==="OWNER")},y=b(!1),w=async()=>{y.value||(y.value=!0,P(Ht(),pe(d=>{y.value=!1,o.error(k(d))},()=>{y.value=!1,a.value=!1,o.success(s("settings.account_deleted")),D.auth.signOutUser(),l.push("/")}))())},k=d=>{if(d.type==="network_error")return s("error.network_error");switch(d.error){case"shortcode/not_found":return s("shortcodes.not_found");default:return s("error.something_went_wrong")}};return(d,m)=>{const g=te,x=se,C=me,$=Ge;return i(),_("section",Tt,[t("h4",jt,n(e(s)("settings.delete_account")),1),t("div",Vt,n(e(s)("settings.delete_account_description")),1),c(g,{filled:"",outline:"",label:e(s)("settings.delete_account"),type:"submit",onClick:m[0]||(m[0]=r=>a.value=!0)},null,8,["label"]),a.value?(i(),A($,{key:0,dialog:"",title:e(s)("settings.delete_account"),onClose:m[3]||(m[3]=r=>a.value=!1)},{body:E(()=>[S.value?(i(),_("div",zt,[c(x,{class:"mb-4"}),t("span",Bt,n(e(s)("state.loading")),1)])):p.value.length?(i(),_("div",qt,[t("h2",Ot,n(e(s)("error.danger_zone")),1),t("div",null,[M(n(e(s)("error.delete_account"))+" ",1),t("ul",Pt,[(i(!0),_(ue,null,he(p.value,r=>(i(),_("li",{key:r.id},n(r.name),1))),128))]),t("span",Yt,n(e(s)("error.delete_account_description")),1)])])):(i(),_("div",Ft,[t("div",Gt,[t("h2",Jt,n(e(s)("error.danger_zone")),1),t("div",Qt,n(e(s)("settings.delete_account_description")),1)]),t("div",Wt,[T(t("input",{id:"deleteUserAccount","onUpdate:modelValue":m[1]||(m[1]=r=>h.value=r),class:"input floating-input",placeholder:" ",type:"text",autocomplete:"off"},null,512),[[ee,h.value]]),Xt])]))]),footer:E(()=>[t("span",Zt,[c(C,{label:e(s)("settings.delete_account"),loading:y.value,filled:"",outline:"",disabled:S.value||p.value.length>0||h.value!=="delete my account",class:"!bg-red-500 !hover:bg-red-600 !border-red-500 !hover:border-red-600",onClick:w},null,8,["label","loading","disabled"]),c(g,{label:e(s)("action.cancel"),outline:"",filled:"",onClick:m[2]||(m[2]=r=>a.value=!1)},null,8,["label"])])]),_:1},8,["title"])):j("",!0)])}}}),es={preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ts=t("g",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"},[t("path",{d:"M12 3c-1.2 0-2.4.6-3 1.7A3.6 3.6 0 0 0 4.6 9c-1 .6-1.7 1.8-1.7 3s.7 2.4 1.7 3c-.3 1.2 0 2.5 1 3.4c.8.8 2.1 1.2 3.3 1c.6 1 1.8 1.6 3 1.6s2.4-.6 3-1.7c1.2.3 2.5 0 3.4-1c.8-.8 1.2-2 1-3.3c1-.6 1.6-1.8 1.6-3s-.6-2.4-1.7-3c.3-1.2 0-2.5-1-3.4a3.7 3.7 0 0 0-3.3-1c-.6-1-1.8-1.6-3-1.6Z"}),t("path",{d:"m9 12l2 2l4-4"})],-1),ss=[ts];function os(f,s){return i(),_("svg",es,ss)}const re={name:"lucide-verified",render:os},ns={class:"container"},ls={class:"p-4"},rs={key:0,class:"flex flex-col items-center justify-center flex-1 p-4"},is={key:1,class:"flex flex-col items-center justify-center"},cs=["src","alt"],as={class:"pb-4 text-center text-secondaryLight"},ds={key:2,class:"space-y-8"},us=t("div",{class:"h-24 rounded bg-primaryLight -mb-11 md:h-32",style:{"background-image":"url('/images/cover.svg')"}},null,-1),hs={class:"flex flex-col justify-between px-4 space-y-8 md:flex-row"},_s={class:"flex items-end"},ps={class:"ml-4"},ms={class:"heading"},fs={class:"flex items-center text-secondaryLight"},vs={class:"flex items-end space-x-2"},ys={class:"grid grid-cols-1"},gs={class:"p-4"},bs={class:"font-semibold text-secondaryDark"},xs={class:"my-1 text-secondaryLight"},$s={class:"py-4"},Ss={for:"displayName"},ws=["onSubmit"],ks=["placeholder"],Cs={class:"py-4"},Ls={for:"emailAddress"},Ds=["onSubmit"],Ns=["placeholder"],Es={class:"p-4"},Us={class:"font-semibold text-secondaryDark"},Ms={class:"my-1 text-secondaryLight"},Rs={class:"py-4 space-y-4"},Is={class:"flex items-center"},As={class:"flex items-center"},Hs={class:"flex items-center"},qs=F({__name:"profile",setup(f){var R,V;const s=b("sync"),o=G(),l=J(),a=_e();de({title:H(()=>o("navigation.profile"))});const h=Z("syncCollections"),S=Z("syncEnvironments"),p=Z("syncHistory"),u=I(D.auth.getCurrentUserStream(),D.auth.getCurrentUser()),y=I(D.auth.getProbableUserStream(),D.auth.getProbableUser()),w=H(()=>y.value?!u.value:!1),k=b((R=u.value)==null?void 0:R.displayName),d=b(!1);Y(()=>{var U;return k.value=(U=u.value)==null?void 0:U.displayName});const m=()=>{d.value=!0,D.auth.setDisplayName(k.value).then(()=>{l.success(`${o("profile.updated")}`)}).catch(()=>{l.error(`${o("error.something_went_wrong")}`)}).finally(()=>{d.value=!1})},g=b((V=u.value)==null?void 0:V.email),x=b(!1);Y(()=>{var U;return g.value=(U=u.value)==null?void 0:U.email});const C=()=>{x.value=!0,D.auth.setEmailAddress(g.value).then(()=>{l.success(`${o("profile.updated")}`)}).catch(()=>{l.error(`${o("error.something_went_wrong")}`)}).finally(()=>{x.value=!1})},$=b(!1),r=()=>{$.value=!0,D.auth.verifyEmailAddress().then(()=>{l.success(`${o("profile.email_verification_mail")}`)}).catch(()=>{l.error(`${o("error.something_went_wrong")}`)}).finally(()=>{$.value=!1})};return(U,v)=>{const Q=se,z=me,B=We,fe=re,W=te,ve=Xe,ye=Ze,ge=Kt,X=Ke,be=At,oe=et,xe=tt,$e=st,Se=ie("tippy");return i(),_("div",null,[t("div",ns,[t("div",ls,[e(w)?(i(),_("div",rs,[c(Q,{class:"mb-4"})])):e(u)===null?(i(),_("div",is,[t("img",{src:`/images/states/${e(a).value}/login.svg`,loading:"lazy",class:"inline-flex flex-col object-contain object-center w-24 h-24 my-4",alt:`${e(o)("empty.parameters")}`},null,8,cs),t("p",as,n(e(o)("empty.profile")),1),c(z,{label:e(o)("auth.login"),class:"mb-4",onClick:v[0]||(v[0]=N=>e(Je)("modals.login.toggle"))},null,8,["label"])])):(i(),_("div",ds,[us,t("div",hs,[t("div",_s,[e(u).photoURL?(i(),A(B,{key:0,url:e(u).photoURL,alt:e(u).displayName||e(o)("profile.default_displayname"),class:"ring-primary ring-4",size:"16",rounded:"lg"},null,8,["url","alt"])):(i(),A(B,{key:1,initial:e(u).displayName||e(u).email,rounded:"lg",size:"16",class:"ring-primary ring-4"},null,8,["initial"])),t("div",ps,[t("label",ms,n(e(u).displayName||e(o)("profile.default_hopp_displayname")),1),t("p",fs,[M(n(e(u).email)+" ",1),e(u).emailVerified?T((i(),A(fe,{key:0,title:e(o)("settings.verified_email"),class:"ml-2 text-green-500 svg-icons focus:outline-none cursor-help"},null,8,["title"])),[[Se,{theme:"tooltip"}]]):(i(),A(W,{key:1,label:e(o)("settings.verify_email"),icon:e(re),class:"px-1 py-0 ml-2",loading:$.value,onClick:r},null,8,["label","icon","loading"]))])])]),t("div",vs,[t("div",null,[c(ve,{to:"/settings",icon:e(Qe),label:e(o)("profile.app_settings"),outline:""},null,8,["icon","label"])]),c(ye,{outline:""})])]),c($e,{modelValue:s.value,"onUpdate:modelValue":v[6]||(v[6]=N=>s.value=N),styles:"sticky overflow-x-auto flex-shrink-0 bg-primary top-0 z-10","render-inactive-tabs":""},{default:E(()=>[c(oe,{id:"sync",label:e(o)("settings.account")},{default:E(()=>[t("div",ys,[t("section",gs,[t("h4",bs,n(e(o)("settings.profile")),1),t("div",xs,n(e(o)("settings.profile_description")),1),t("div",$s,[t("label",Ss,n(e(o)("settings.profile_name")),1),t("form",{class:"flex mt-2 md:max-w-sm",onSubmit:le(m,["prevent"])},[T(t("input",{id:"displayName","onUpdate:modelValue":v[1]||(v[1]=N=>k.value=N),class:"input",placeholder:`${e(o)("settings.profile_name")}`,type:"text",autocomplete:"off",required:""},null,8,ks),[[ee,k.value]]),c(W,{filled:"",outline:"",label:e(o)("action.save"),class:"ml-2 min-w-16",type:"submit",loading:d.value},null,8,["label","loading"])],40,ws)]),t("div",Cs,[t("label",Ls,n(e(o)("settings.profile_email")),1),t("form",{class:"flex mt-2 md:max-w-sm",onSubmit:le(C,["prevent"])},[T(t("input",{id:"emailAddress","onUpdate:modelValue":v[2]||(v[2]=N=>g.value=N),class:"input",placeholder:`${e(o)("settings.profile_name")}`,type:"email",autocomplete:"off",required:""},null,8,Ns),[[ee,g.value]]),c(W,{filled:"",outline:"",label:e(o)("action.save"),class:"ml-2 min-w-16",type:"submit",loading:x.value},null,8,["label","loading"])],40,Ds)])]),c(ge),t("section",Es,[t("h4",Us,n(e(o)("settings.sync")),1),t("div",Ms,n(e(o)("settings.sync_description")),1),t("div",Rs,[t("div",Is,[c(X,{on:e(h),onChange:v[3]||(v[3]=N=>e(K)("syncCollections"))},{default:E(()=>[M(n(e(o)("settings.sync_collections")),1)]),_:1},8,["on"])]),t("div",As,[c(X,{on:e(S),onChange:v[4]||(v[4]=N=>e(K)("syncEnvironments"))},{default:E(()=>[M(n(e(o)("settings.sync_environments")),1)]),_:1},8,["on"])]),t("div",Hs,[c(X,{on:e(p),onChange:v[5]||(v[5]=N=>e(K)("syncHistory"))},{default:E(()=>[M(n(e(o)("settings.sync_history")),1)]),_:1},8,["on"])])])]),c(be)])]),_:1},8,["label"]),c(oe,{id:"teams",label:e(o)("team.title")},{default:E(()=>[c(xe,{modal:!1,class:"p-4"})]),_:1},8,["label"])]),_:1},8,["modelValue"])]))])])])}}});export{qs as default};
//# sourceMappingURL=profile.758bcc5d.js.map
